<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Jalamburguers & JalFits - Comida saludable y Gimnasio Premium.">
  <title>Jalamburguers & JalFits</title>
  <style>
    /* ================================================================
       1. ARQUITECTURA DE TEMAS Y VARIABLES GLOBALES
       ================================================================ */
    :root {
      /* TEMA: HAMBURGUESERÍA (Naranja / Luminoso) */
      --color-bg: #f5f1ed;
      --color-card: #ffffff;
      --color-border: #e6dfd5;
      --color-text: #2c2c2c;
      --color-text-light: #7a7a7a;
      --color-accent: #ff8800;
      --color-accent-dark: #d35400;
      --btn-grad-1: #ff6b6b;
      --btn-grad-2: #d82b2b;
      --hero-bg: linear-gradient(135deg, #ffe600 0%, #ff8800 100%);
      --hero-overlay: linear-gradient(135deg, rgba(255, 230, 0, 0.7) 0%, rgba(255, 136, 0, 0.7) 100%);
      
      --nav-bg: #ffffff; 
      --nav-link-color: #2c2c2c; 
      --nav-border: #e6dfd5;
      
      --max-width: 1200px;
      --border-radius: 16px;
      --font-primary: 'Segoe UI', system-ui, -apple-system, sans-serif;
      --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 12px 32px rgba(0, 0, 0, 0.15);
    }

    body.gym-theme {
      /* TEMA: GIMNASIO (Negro / Esmeralda) */
      --color-bg: #0a0f15;
      --color-card: #121921;
      --color-border: #1e293b;
      --color-text: #f8fafc;
      --color-text-light: #94a3b8;
      --color-accent: #10b981;
      --color-accent-dark: #059669;
      --btn-grad-1: #10b981;
      --btn-grad-2: #059669;
      --hero-bg: linear-gradient(135deg, #0f1419 0%, #000000 100%);
      --hero-overlay: linear-gradient(135deg, rgba(16, 185, 129, 0.7) 0%, rgba(0, 0, 0, 0.8) 100%);
      
      --nav-bg: #121921; 
      --nav-link-color: #ffffff; 
      --nav-border: #1e293b;
    }

    /* ================================================================
       2. RESET Y ESTRUCTURA BASE
       ================================================================ */
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html { scroll-behavior: smooth; }
    body { margin: 0; padding: 0; font-family: var(--font-primary); background-color: var(--color-bg); color: var(--color-text); line-height: 1.6; transition: background-color 0.4s ease, color 0.4s ease; overflow-x: hidden; }
    .container { max-width: var(--max-width); margin: 0 auto; padding: 0 20px; }
    
    .icon { width: 1.2em; height: 1.2em; vertical-align: -0.15em; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; margin-right: 4px; display: inline-block;}

    .app-view { display: none; }
    .app-view.active { display: block; animation: fadeIn 0.4s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* ================================================================
       3. NAVEGACIÓN STICKY Y MENÚ MÓVIL
       ================================================================ */
    .sticky-nav-container { position: sticky; top: 10px; z-index: 1000; padding: 0 20px; transition: transform 0.3s ease; }
    .nav-row { display: flex; align-items: center; justify-content: space-between; padding: 12px 25px; background: var(--nav-bg); border-radius: 50px; border: 1px solid var(--nav-border); box-shadow: var(--shadow-md); transition: all 0.4s ease; }
    
    .nav-logo { font-weight: 900; font-size: 1.2rem; color: var(--nav-link-color); text-decoration: none; display: flex; align-items: center; gap: 10px; }
    .nav-logo img { width: 35px; height: 35px; border-radius: 50%; object-fit: cover; border: 2px solid var(--color-accent); }

    .main-nav { display: flex; gap: 20px; align-items: center; }
    .main-nav a { color: var(--nav-link-color); text-decoration: none; font-weight: 700; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.5px; transition: color 0.3s; cursor: pointer; display: flex; align-items: center;}
    .main-nav a:hover { color: var(--color-accent); }
    
    .menu-toggle { display: none; background: none; border: none; color: var(--nav-link-color); font-size: 1.8rem; cursor: pointer; padding: 0; }

    /* Estilo del Badge del Carrito en el Header */
    .cart-badge { background: #ef4444; color: white; border-radius: 50%; padding: 2px 8px; font-size: 0.8rem; font-weight: bold; margin-left: 5px; }

    /* ================================================================
       4. HEADER HERO & LOGO2.JPG 
       ================================================================ */
    header.hero { position: relative; overflow: hidden; padding-bottom: 80px; background: var(--hero-bg); transition: background 0.4s ease; }
    .hero-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; opacity: 0.2; }
    .hero-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--hero-overlay); z-index: 1; }
    
    .hero-inner { position: relative; z-index: 3; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px; text-align: center; }
    
    .banner-wrapper { position: relative; width: 100%; max-width: 800px; aspect-ratio: 16/9; display: flex; align-items: center; justify-content: center; filter: drop-shadow(0 15px 35px rgba(0,0,0,0.3)); margin: 0 auto; }
    .banner-bg-img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: fill; border-radius: 20px; z-index: 0; }
    
    .banner-content { position: relative; z-index: 1; width: 70%; display: flex; flex-direction: column; gap: 15px; align-items: center; }
    .banner-content h1 { font-size: clamp(1.8rem, 4vw, 3.5rem); font-weight: 900; color: #1a1a1a; margin: 0; line-height: 1.1; text-transform: uppercase; letter-spacing: -1px; }
    .banner-content .lead { font-size: clamp(0.9rem, 2vw, 1.2rem); color: #333; margin: 0; font-weight: 700; }

    .hero-inner-gym { position: relative; z-index: 3; display: flex; flex-direction: column; align-items: flex-start; justify-content: center; gap: 20px; padding: 80px 20px; max-width: var(--max-width); margin: 0 auto;}
    .hero-inner-gym h1 { font-size: clamp(2.5rem, 6vw, 4.5rem); font-weight: 900; color: white; margin: 0; text-shadow: 2px 2px 10px rgba(0,0,0,0.5); line-height: 1.1; }
    .hero-inner-gym .lead { font-size: 1.2rem; color: rgba(255, 255, 255, 0.9); max-width: 500px; margin: 0; }

    /* ================================================================
       5. BOTONES E INTERFACES
       ================================================================ */
    .btn { background: linear-gradient(135deg, var(--btn-grad-1) 0%, var(--btn-grad-2) 100%); color: white; padding: 12px 28px; border-radius: 50px; font-weight: 800; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 1px; border: none; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); box-shadow: 0 6px 20px rgba(0,0,0,0.2); text-decoration: none; }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.3); color: white; }
    .btn.ghost { background: transparent; border: 2px solid #1a1a1a; color: #1a1a1a; box-shadow: none; }
    .btn.ghost:hover { background: #1a1a1a; color: white; }
    body.gym-theme .btn.ghost { border-color: white; color: white; }
    body.gym-theme .btn.ghost:hover { background: white; color: var(--color-bg); }
    
    .hero-actions { display: flex; gap: 15px; margin-top: 10px; flex-wrap: wrap; justify-content: center; }
    
    .menu-dropdown-btn { background: var(--color-card); color: var(--color-text); border: 2px solid var(--color-border); padding: 10px 20px; border-radius: 50px; cursor: pointer; font-weight: 700; transition: all 0.3s ease; font-size: 0.9rem; text-transform: uppercase; white-space: nowrap; display: flex; align-items: center;}
    .menu-dropdown-btn:hover { border-color: var(--color-accent); transform: translateY(-2px); }
    .menu-dropdown-btn.active { background: linear-gradient(135deg, var(--btn-grad-1) 0%, var(--btn-grad-2) 100%); color: white; border-color: transparent; box-shadow: 0 6px 15px rgba(0,0,0,0.15); }

    /* ================================================================
       6. TARJETAS Y GRID
       ================================================================ */
    section { padding: 60px 0; }
    section h2 { font-size: clamp(2rem, 4vw, 2.5rem); font-weight: 900; margin-bottom: 10px; color: var(--color-text); display: flex; align-items: center; gap: 10px;}
    .muted { color: var(--color-text-light); font-size: 1.1rem; margin-bottom: 30px; }

    .metrics { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; background-color: var(--color-card); padding: 25px; border-radius: var(--border-radius); border: 1px solid var(--color-border); margin: -40px auto 40px auto; box-shadow: var(--shadow-md); position: relative; z-index: 10; max-width: 900px;}
    .metrics > div { text-align: center; }
    .metrics h3 { font-size: 0.85rem; color: var(--color-text-light); text-transform: uppercase; margin: 0 0 5px 0; letter-spacing: 1px; display: flex; justify-content: center; align-items: center;}
    .metrics span { font-size: 2.5rem; font-weight: 900; color: var(--color-accent); line-height: 1; }

    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
    .card { background-color: var(--color-card); border: 1px solid var(--color-border); border-radius: var(--border-radius); padding: 20px; display: flex; flex-direction: column; transition: all 0.3s ease; box-shadow: var(--shadow-sm); position: relative; }
    .card:hover { transform: translateY(-8px); box-shadow: var(--shadow-lg); border-color: var(--color-accent); }
    .card-image { width: 100%; height: 200px; overflow: hidden; border-radius: 10px 10px 0 0; margin: -20px -20px 15px -20px; position: relative; }
    .card-image img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s ease; }
    .card:hover .card-image img { transform: scale(1.1); }
    
    .badge { position: absolute; top: 12px; right: 12px; background: linear-gradient(135deg, var(--color-accent), var(--color-accent-dark)); color: white; padding: 5px 12px; border-radius: 20px; font-size: 0.7rem; font-weight: 800; text-transform: uppercase; box-shadow: 0 4px 10px rgba(0,0,0,0.3); letter-spacing: 1px;}
    
    .card h3 { margin: 0 0 8px 0; font-size: 1.3rem; font-weight: 800; color: var(--color-text);}
    .card p { margin: 0 0 15px 0; color: var(--color-text-light); flex: 1; font-size: 0.95rem; line-height: 1.5;}
    .card .price { font-size: 1.8rem; font-weight: 900; color: var(--color-accent); margin-bottom: 15px; }

    .menu-category { display: none; }
    .menu-category.active { display: block; animation: fadeIn 0.4s ease; }

    .card.reward { align-items: center; text-align: center; justify-content: center;}
    .reward-icon { margin-bottom: 15px; color: var(--color-accent); }
    .reward-icon svg { width: 60px; height: 60px; }

    /* ================================================================
       7. COMPONENTES GYM Y CARRUSEL
       ================================================================ */
    .carousel { position: relative; width: 100%; height: 70vh; overflow: hidden; border-radius: 0 0 30px 30px; box-shadow: var(--shadow-lg);}
    .carousel-slide { position: absolute; width: 100%; height: 100%; opacity: 0; transition: opacity 0.8s ease-in-out; background: #000; }
    .carousel-slide.active { opacity: 1; z-index: 10; }
    .carousel-slide img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.4) contrast(1.1); }
    .carousel-slide-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: white; z-index: 20; width: 90%; text-shadow: 2px 2px 10px rgba(0,0,0,0.9); }
    .carousel-slide-text h2 { font-size: clamp(2rem, 5vw, 4rem); font-weight: 900; margin-bottom: 10px; color: var(--color-accent); text-transform: uppercase; }
    .carousel-slide-text p { font-size: clamp(1rem, 2vw, 1.5rem); font-weight: 300; margin:0;}
    .carousel-controls { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; z-index: 30; }
    .carousel-btn { width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; background: rgba(255,255,255,0.2); cursor: pointer; transition: 0.3s; padding:0;}
    .carousel-btn.active { background: var(--color-accent); border-color: var(--color-accent); width: 30px; border-radius: 10px; }

    .plan-card-expanded { background: var(--color-card); border: 1px solid var(--color-border); border-radius: 16px; padding: 35px 25px; text-align: center; transition: 0.4s; position: relative; display: flex; flex-direction: column;}
    .plan-card-expanded.featured { background: linear-gradient(135deg, #059669 0%, #047857 100%); border: none; transform: scale(1.03); color: white;}
    .plan-badge { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: #ff8800; color: white; padding: 6px 15px; border-radius: 20px; font-weight: bold; font-size: 0.75rem; letter-spacing: 1px; }

    /* ================================================================
       8. MODALES, FORMULARIOS Y TOASTS
       ================================================================ */
    .form-group { display: flex; flex-direction: column; gap: 8px; margin-bottom: 15px; text-align: left;}
    .form-group label { font-weight: 700; font-size: 0.9rem; color: var(--color-text);}
    .form-group input, .form-group select { padding: 12px; border: 2px solid var(--color-border); border-radius: 10px; font-family: inherit; background-color: var(--color-bg); color: var(--color-text); font-size: 16px; transition: border 0.3s;}
    .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--color-accent); }
    
    /* Configuración para Opciones Personalizables (Ingredientes extra/quitar) */
    .custom-option { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; border: 1px solid var(--color-border); border-radius: 8px; margin-bottom: 8px; background: var(--color-bg); cursor: pointer;}
    .custom-option:hover { border-color: var(--color-accent); }
    .custom-option input[type="checkbox"] { margin: 0; width: 18px; height: 18px; accent-color: var(--color-accent); cursor: pointer;}
    .custom-option-price { font-weight: bold; color: var(--color-accent); }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: 0.3s; backdrop-filter: blur(5px); padding: 20px; }
    .modal-overlay.active { opacity: 1; visibility: visible; }
    .modal { background: var(--color-card); border-radius: 20px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; padding: 30px; transform: translateY(20px); transition: 0.3s; color: var(--color-text); box-shadow: 0 20px 40px rgba(0,0,0,0.3); border: 1px solid var(--color-border);}
    .modal-overlay.active .modal { transform: translateY(0); }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid var(--color-border); padding-bottom: 15px; }
    .modal-header h2 { margin: 0; font-size: 1.5rem; color: var(--color-text); display:flex; align-items:center; gap:8px;}
    .modal-close { background: none; border: none; font-size: 1.8rem; cursor: pointer; color: var(--color-text-light); transition: color 0.3s; padding:0;}
    .modal-close:hover { color: #ef4444; }

    .auth-tab { display: none; }
    .auth-tab.active { display: block; animation: fadeIn 0.3s; }

    .toast-container { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 10000; display: flex; flex-direction: column; gap: 10px; width: 90%; max-width: 400px; pointer-events: none;}
    .toast { background: var(--color-card); color: var(--color-text); padding: 15px 20px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); border-left: 6px solid; display: flex; align-items: center; gap: 15px; font-weight: 600; animation: slideUpToast 0.4s ease; pointer-events: auto;}
    .toast.success { border-color: #10b981; } .toast.error { border-color: #ef4444; }
    .toast-close { background:none; border:none; font-size:20px; cursor:pointer; color: var(--color-text-light); margin-left:auto;}
    @keyframes slideUpToast { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* ================================================================
       9. LEGAL Y FOOTER
       ================================================================ */
    .legal-view-bg { padding: 40px 20px; }
    .legal-container { max-width: 800px; margin: 0 auto; background: var(--color-card); border-radius: 16px; padding: 40px; box-shadow: var(--shadow-sm); color: var(--color-text); border: 1px solid var(--color-border);}
    .legal-container h1 { font-size: clamp(1.8rem, 4vw, 2.5rem); margin-bottom: 20px; border-bottom: 3px solid var(--color-accent); padding-bottom: 15px; color: var(--color-text);}
    .legal-container h2 { color: var(--color-accent); margin-top: 30px; font-size: 1.3rem; font-weight: 800;}
    
    .site-footer { background-color: #0a0f15; color: white; padding: 60px 0 30px 0; margin-top: 60px; border-top: 5px solid var(--color-accent); }
    .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; }
    .footer-grid h4 { color: white; font-size: 1.2rem; margin-bottom: 20px; font-weight: 800; }
    .footer-grid a { color: #94a3b8; text-decoration: none; display: block; margin-bottom: 10px; transition: 0.3s; font-size: 0.95rem;}
    .footer-grid a:hover { color: var(--color-accent); padding-left: 5px; }

    /* ================================================================
       10. RESPONSIVO MÓVIL
       ================================================================ */
    @media (max-width: 768px) {
      .sticky-nav-container { padding: 0 10px; top: 10px; }
      .nav-row { padding: 10px 20px; border-radius: 20px; flex-wrap: wrap;}
      .menu-toggle { display: block; }
      
      .main-nav { display: none; width: 100%; flex-direction: column; gap: 15px; padding-top: 15px; margin-top: 10px; border-top: 1px solid rgba(0,0,0,0.1); }
      body.gym-theme .main-nav { border-top-color: rgba(255,255,255,0.1); }
      .main-nav.active-mobile { display: flex; animation: fadeIn 0.3s ease; }
      
      .banner-content { width: 90%; padding: 5% 0;}
      .banner-wrapper { aspect-ratio: 4/3; } 
      
      .hero-actions { flex-direction: column; width: 100%; }
      .hero-actions .btn { width: 100%; }
      
      .metrics { margin-top: -20px; grid-template-columns: 1fr; padding: 20px;}
      .card { padding: 20px; }
      .plan-card-expanded.featured { transform: scale(1); }
      .plan-card-expanded.featured:hover { transform: translateY(-5px); }
      
      .legal-container { padding: 25px; margin-top: 20px;}
      
      #products > div:first-of-type { flex-wrap: nowrap; overflow-x: auto; padding-bottom: 10px; justify-content: flex-start !important; -webkit-overflow-scrolling: touch; }
      .menu-dropdown-btn { flex: 0 0 auto; }
    }
  </style>
</head>
<body>

  <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
    <symbol id="i-menu" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"/></symbol>
    <symbol id="i-login" viewBox="0 0 24 24"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></symbol>
    <symbol id="i-user" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></symbol>
    <symbol id="i-cart" viewBox="0 0 24 24"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></symbol>
    <symbol id="i-search" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></symbol>
    <symbol id="i-credit-card" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></symbol>
    
    <symbol id="i-gift" viewBox="0 0 24 24"><polyline points="20 12 20 22 4 22 4 12"/><rect x="2" y="7" width="20" height="5"/><line x1="12" y1="22" x2="12" y2="7"/><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"/><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"/></symbol>
    <symbol id="i-bag" viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></symbol>
    <symbol id="i-money" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></symbol>
    
    <symbol id="i-burger" viewBox="0 0 24 24"><path d="M3 11a9 9 0 0 1 18 0H3z"/><path d="M21 16a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2h18v2z"/></symbol>
    <symbol id="i-plate" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 2v20"/></symbol>
    <symbol id="i-salad" viewBox="0 0 24 24"><path d="M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10 10 10 0 0 1-10-10A10 10 0 0 1 12 2z"/><path d="M8 12c1.5-1.5 3.5-1.5 5 0"/></symbol>
    <symbol id="i-cup" viewBox="0 0 24 24"><path d="M6 5h12l-1.5 15H7.5L6 5z"/><path d="M10 5V2h4v3"/></symbol>
    <symbol id="i-cake" viewBox="0 0 24 24"><path d="M20 21H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2z"/><path d="M12 7v14"/></symbol>
    <symbol id="i-box" viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></symbol>
    <symbol id="i-ticket" viewBox="0 0 24 24"><path d="M2 9V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a3 3 0 0 0 0 6v4a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-4a3 3 0 0 0 0-6Z"/><path d="M13 3v20"/></symbol>
    
    <symbol id="i-gym" viewBox="0 0 24 24"><path d="M6.5 6.5h11"/><path d="M6.5 17.5h11"/><path d="M3 6.5v11"/><path d="M21 6.5v11"/><path d="M6.5 9v6"/><path d="M17.5 9v6"/></symbol>
  </svg>

  <div id="view-jalamburguers" class="app-view active">
    
    <div class="sticky-nav-container">
      <nav class="nav-row">
        <a href="#jalamburguers" class="nav-logo" id="main-logo-text">
          <img src="images/logo1.png" alt="Logo" id="main-logo-img" onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 100 100\'><circle cx=\'50\' cy=\'50\' r=\'50\' fill=\'%23f97316\'/></svg>'">
          Jalamburguers
        </a>
        <button class="menu-toggle" onclick="toggleMobileMenu()">
          <svg class="icon" style="margin:0;"><use href="#i-menu"/></svg>
        </button>
        <nav class="main-nav">
          <a onclick="navigateAndScroll('view-jalamburguers', 'products')">Menú</a>
          <a onclick="navigateAndScroll('view-jalamburguers', 'rewards')">Recompensas</a>
          <a onclick="navigateAndScroll('view-jalfits', 'view-jalfits')">Gym JalFits</a>
          
          <a onclick="openCartModal()" style="color: var(--color-accent); font-weight: 800;">
            <svg class="icon"><use href="#i-cart"/></svg> Carrito <span class="cart-badge" id="cart-count-badge">0</span>
          </a>

          <button class="btn auth-btn" style="padding: 8px 20px; font-size: 0.85rem; border:none; margin-left:10px;">
            <svg class="icon"><use href="#i-login"/></svg> Ingresar
          </button>
        </nav>
      </nav>
    </div>

    <header class="hero">
      <video autoplay muted loop playsinline class="hero-video">
        <source src="https://cdn.pixabay.com/vimeo/32959666/burger-23136.mp4?width=1280&hash=0e08c691be02bcbb2638fec3a1d9539327850dfd" type="video/mp4">
      </video>
      <div class="hero-overlay"></div>

      <div class="container">
        <div class="hero-inner">
          <div class="banner-wrapper">
            <img src="images/logo2.jpg" alt="Jalamburguers Banner" class="banner-bg-img" onerror="this.style.display='none'; this.parentElement.style.background='var(--color-accent)';">
            <div class="banner-content">
              <h1>Entrena.<br>Come Sano.<br>Gana Puntos.</h1>
              <p class="lead">Las mejores hamburguesas proteicas y beneficios exclusivos para deportistas de élite.</p>
              <div class="hero-actions">
                <button onclick="navigateAndScroll('view-jalamburguers', 'products')" class="btn" style="border:none;">
                  <svg class="icon"><use href="#i-bag"/></svg> Hacer Pedido
                </button>
                <a onclick="navigateAndScroll('view-jalfits', 'view-jalfits')" class="btn ghost" style="cursor:pointer;">
                  <svg class="icon"><use href="#i-gym"/></svg> Descubrir Gimnasio
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main>
      <section class="container" style="padding-top:0;">
        <div class="metrics">
          <div><h3><svg class="icon"><use href="#i-gift"/></svg> Mis Puntos</h3><span id="points">0</span></div>
          <div><h3><svg class="icon"><use href="#i-bag"/></svg> Pedidos</h3><span id="purchases">0</span></div>
          <div><h3><svg class="icon"><use href="#i-money"/></svg> Inversión</h3><span id="revenue">0€</span></div>
        </div>
      </section>

      <section id="products" class="container">
        <h2><svg class="icon" style="width:36px;height:36px;color:var(--color-accent);"><use href="#i-burger"/></svg> Nuestro Menú Premium</h2>
        <p class="muted">Ingredientes frescos, macros calculados y sabor increíble diseñado para tu recuperación.</p>
        
        <div style="display: flex; flex-wrap: wrap; gap:10px; margin-bottom: 40px; justify-content:center;">
          <button class="menu-dropdown-btn active" onclick="showCategory(event, 'burgers')">Hamburguesas</button>
          <button class="menu-dropdown-btn" onclick="showCategory(event, 'platos')">Platos Combinados</button>
          <button class="menu-dropdown-btn" onclick="showCategory(event, 'entrantes')">Entrantes</button>
          <button class="menu-dropdown-btn" onclick="showCategory(event, 'bebidas')">Bebidas</button>
          <button class="menu-dropdown-btn" onclick="showCategory(event, 'postres')">Postres FIT</button>
        </div>

        <div class="menu-container">
          <div id="burgers" class="menu-category active">
            <div class="grid">
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?auto=format&fit=crop&w=600&q=80" alt="Burger"><span class="badge">BESTSELLER</span></div><h3>JalBurger Proteica</h3><p>Doble carne magra + pan de masa madre + salsa cero calorías.</p><p class="price">8.50€</p><button class="btn" onclick="openCustomize(1, 'JalBurger Proteica', 8.5, 10, 'burger')">Personalizar • +10 pts</button></div>
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1525059696034-4967a8e1dca2?auto=format&fit=crop&w=600&q=80" alt="Vegan"><span class="badge">VEGAN</span></div><h3>JalVegan Power</h3><p>Patty de heura + aguacate fresco + pan de espinacas.</p><p class="price">7.90€</p><button class="btn" onclick="openCustomize(2, 'JalVegan Power', 7.9, 9, 'burger')">Personalizar • +9 pts</button></div>
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1606755962773-d324e0a13086?auto=format&fit=crop&w=600&q=80" alt="Chicken"><span class="badge">PREMIUM</span></div><h3>Chicken Boost</h3><p>Pechuga marinada a baja temp + queso proteico.</p><p class="price">9.00€</p><button class="btn" onclick="openCustomize(3, 'Chicken Boost', 9, 11, 'burger')">Personalizar • +11 pts</button></div>
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1550547660-d9450f859349?auto=format&fit=crop&w=600&q=80" alt="BBQ"><span class="badge">PICANTE</span></div><h3>BBQ Fit</h3><p>Carne ahumada + jalapeños + bacon de pavo.</p><p class="price">8.50€</p><button class="btn" onclick="openCustomize(4, 'BBQ Fit', 8.5, 11, 'burger')">Personalizar • +11 pts</button></div>
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1586190848861-99aa4a171e90?auto=format&fit=crop&w=600&q=80" alt="Mediterranea"><span class="badge">SANA</span></div><h3>Mediterranean</h3><p>Feta + tomate seco + yogur griego + almendras.</p><p class="price">10.00€</p><button class="btn" onclick="openCustomize(5, 'Mediterranean', 10, 13, 'burger')">Personalizar • +13 pts</button></div>
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?auto=format&fit=crop&w=600&q=80" alt="Triple"><span class="badge">DELUXE</span></div><h3>Triple Stack</h3><p>3 patties de carne magra + huevo a la plancha.</p><p class="price">12.00€</p><button class="btn" onclick="openCustomize(6, 'Triple Stack', 12, 15, 'burger')">Personalizar • +15 pts</button></div>
            </div>
          </div>

          <div id="platos" class="menu-category">
            <div class="grid">
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1594212699903-eca40ac91325?auto=format&fit=crop&w=600&q=80" alt="Power"></div><h3>Combo Power</h3><p>Burger a elegir + papas al horno + bebida proteica</p><p class="price">15.00€</p><button class="btn" onclick="openCustomize(9, 'Combo Power', 15, 20, 'combo')">Personalizar • +20 pts</button></div>
            </div>
          </div>

          <div id="entrantes" class="menu-category">
            <div class="grid">
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1576107232684-1279f3908594?auto=format&fit=crop&w=600&q=80" alt="Papas"></div><h3>Papas Caseras</h3><p>Al horno con aceite de oliva y sal marina.</p><p class="price">3.50€</p><button class="btn" onclick="openCustomize(13, 'Papas Caseras', 3.5, 4, 'side')">Personalizar • +4 pts</button></div>
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1512621776951-a57141f2eefd?auto=format&fit=crop&w=600&q=80" alt="Ensalada"></div><h3>Ensalada Premium</h3><p>Mix de hojas, aguacate, nueces y vinagreta.</p><p class="price">5.00€</p><button class="btn" onclick="openCustomize(14, 'Ensalada Premium', 5, 6, 'salad')">Personalizar • +6 pts</button></div>
            </div>
          </div>

          <div id="bebidas" class="menu-category">
            <div class="grid">
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1626844131082-256783844137?auto=format&fit=crop&w=600&q=80" alt="Shake"></div><h3>Whey Shake</h3><p>30g de proteína aislada sabor vainilla o chocolate.</p><p class="price">4.50€</p><button class="btn" onclick="openCustomize(19, 'Whey Shake', 4.5, 5, 'drink')">Personalizar • +5 pts</button></div>
            </div>
          </div>

          <div id="postres" class="menu-category">
            <div class="grid">
              <div class="card"><div class="card-image"><img src="https://images.unsplash.com/photo-1565958011703-44f9829ba187?auto=format&fit=crop&w=600&q=80" alt="Brownie"></div><h3>Brownie Keto</h3><p>Harina de almendras y chocolate 90% puro.</p><p class="price">4.00€</p><button class="btn" onclick="openCustomize(25, 'Brownie Keto', 4, 5, 'dessert')">Personalizar • +5 pts</button></div>
            </div>
          </div>
        </div>
      </section>

      <section id="rewards" class="container">
        <h2><svg class="icon" style="width:36px;height:36px;color:var(--color-accent);"><use href="#i-gift"/></svg> Canjea tus Puntos</h2>
        <p class="muted">Aprovecha tu esfuerzo. Usa tus puntos para descuentos o meses gratis en JalFits.</p>
        <div class="grid">
          <div class="card reward">
            <div class="reward-icon"><svg class="icon"><use href="#i-cup"/></svg></div>
            <h3>Bebida Gratis</h3><p style="margin-bottom:15px; color:var(--color-text-light);">70 Puntos</p>
            <button class="btn ghost" onclick="redeemReward('Bebida Gratis', 70)">Canjear</button>
          </div>
          <div class="card reward">
            <div class="reward-icon"><svg class="icon"><use href="#i-burger"/></svg></div>
            <h3>Burger Gratis</h3><p style="margin-bottom:15px; color:var(--color-text-light);">150 Puntos</p>
            <button class="btn" onclick="redeemReward('Hamburguesa Gratis', 150)">Canjear</button>
          </div>
          <div class="card reward">
            <div class="reward-icon"><svg class="icon"><use href="#i-gym"/></svg></div>
            <h3>Mes Gym JalFits</h3><p style="margin-bottom:15px; color:var(--color-text-light);">300 Puntos</p>
            <button class="btn" onclick="redeemReward('Membresía JalFits', 300)">Canjear</button>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-grid">
        <div><h4>Jalamburguers</h4><p>Alta cocina deportiva para resultados reales.</p></div>
        <div><h4>Legal</h4><a onclick="navigateAndScroll('view-privacy', 'view-privacy')" style="cursor:pointer;">Privacidad (RGPD)</a><a onclick="navigateAndScroll('view-terms', 'view-terms')" style="cursor:pointer;">Términos de Servicio</a></div>
        <div><h4>Centros</h4><a onclick="navigateAndScroll('view-jalfits', 'view-jalfits')" style="cursor:pointer;">Visitar JalFits Gym</a></div>
      </div>
    </footer>
  </div>


  <div id="view-jalfits" class="app-view">
    
    <div class="sticky-nav-container">
      <nav class="nav-row">
        <a href="#jalfits" class="nav-logo" style="color:var(--color-accent);">
          <img src="images/gym-logo.png" alt="Logo" onerror="this.style.display='none'">
          JalFits
        </a>
        <button class="menu-toggle" onclick="toggleMobileMenu()">
          <svg class="icon" style="margin:0;"><use href="#i-menu"/></svg>
        </button>
        <nav class="main-nav">
          <a onclick="navigateAndScroll('view-jalfits', 'plans')">Planes</a>
          <a href="#jalamburguers">← Volver a Burgers</a>
          <button class="btn auth-btn" style="padding: 8px 20px; font-size: 0.85rem; width: 100%; border:none;">
            <svg class="icon"><use href="#i-user"/></svg> Mi Cuenta
          </button>
        </nav>
      </nav>
    </div>

    <header class="hero" style="padding-top: 0;">
      <div class="hero-overlay"></div>
      <div class="container">
        <div class="hero-inner-gym">
          <h1 style="color:var(--color-accent);">Forja tu mejor versión</h1>
          <p class="lead">Maquinaria de élite, espacio funcional y conexión total con tu nutrición.</p>
          <div class="hero-actions">
            <button onclick="navigateAndScroll('view-jalfits', 'plans')" class="btn" style="border:none;">Ver Planes</button>
          </div>
        </div>
      </div>
    </header>

    <section class="carousel" id="gym-carousel">
      <div class="carousel-slide active">
        <img src="https://images.unsplash.com/photo-1534438327276-14e5300c3a48?auto=format&fit=crop&w=1200&q=80" alt="Pesas">
        <div class="carousel-slide-text"><h2>ÁREA DE PESAS</h2><p>Más de 2000kg en discos y mancuernas olímpicas.</p></div>
      </div>
      <div class="carousel-slide">
        <img src="https://images.unsplash.com/photo-1517836357463-d25dfeac3438?auto=format&fit=crop&w=1200&q=80" alt="Crossfit">
        <div class="carousel-slide-text"><h2>ZONA FUNCIONAL</h2><p>Racks de CrossFit y material de alta intensidad.</p></div>
      </div>
      <div class="carousel-slide">
        <img src="https://images.unsplash.com/photo-1540497077202-7c8a3999166f?auto=format&fit=crop&w=1200&q=80" alt="Cardio">
        <div class="carousel-slide-text"><h2>CARDIO PREMIUM</h2><p>Cintas interactivas con simulación virtual.</p></div>
      </div>
      <div class="carousel-controls" id="carousel-dots">
        <button class="carousel-btn active" onclick="carouselGoTo(0)"></button>
        <button class="carousel-btn" onclick="carouselGoTo(1)"></button>
        <button class="carousel-btn" onclick="carouselGoTo(2)"></button>
      </div>
    </section>

    <main>
      <section id="plans" class="container">
        <h2 style="text-align:center;"><svg class="icon"><use href="#i-ticket"/></svg> Membresías JalFits</h2>
        <p class="muted" style="text-align:center;">Elige el plan que se adapte a tu ritmo. Sin ataduras.</p>
        <div class="grid">
          <div class="plan-card-expanded">
            <h3 style="font-size: 2rem; margin:0;">Básico</h3>
            <p class="price" style="font-size: 3.5rem; margin:10px 0;">29€<small style="font-size:1rem; color:var(--color-text-light);">/mes</small></p>
            <p style="margin-bottom: 20px; font-weight: 600;">Acceso 24/7 a sala fitness</p>
            <button class="btn ghost" style="width:100%; margin-top:auto;" onclick="selectPlan('Basico', 29)">Seleccionar</button>
          </div>
          <div class="plan-card-expanded featured">
            <div class="plan-badge">PREMIUM</div>
            <h3 style="font-size: 2rem; margin:0; color:white;">Total</h3>
            <p class="price" style="font-size: 3.5rem; margin:10px 0; color:white;">59€<small style="font-size:1rem; color:#ddd;">/mes</small></p>
            <p style="margin-bottom: 20px; font-weight: 600; color:white;">Acceso + Clases + 4 Asesorías</p>
            <button class="btn" style="width:100%; margin-top:auto;" onclick="selectPlan('Total', 59)">Seleccionar</button>
          </div>
          <div class="plan-card-expanded">
            <h3 style="font-size: 2rem; margin:0;">Pase Día</h3>
            <p class="price" style="font-size: 3.5rem; margin:10px 0;">12€<small style="font-size:1rem; color:var(--color-text-light);">/día</small></p>
            <p style="margin-bottom: 20px; font-weight: 600;">Prueba sin compromisos</p>
            <button class="btn ghost" style="width:100%; margin-top:auto;" onclick="selectPlan('PaseDia', 12)">Seleccionar</button>
          </div>
        </div>
      </section>

      <section class="container" style="background: var(--color-card); padding: 40px; border-radius: 20px; margin: 50px auto; border: 1px solid var(--color-border); box-shadow: var(--shadow-sm);">
        <h2 style="text-align: center; font-size:clamp(1.5rem, 3vw, 2rem);"><svg class="icon"><use href="#i-search"/></svg> Portal del Socio</h2>
        <p style="text-align: center; color: var(--color-text-light); margin-bottom: 20px;">Verifica la caducidad de tu tarjeta (Ej: JAL-1234-ABCD)</p>
        <div style="display: flex; gap: 10px; max-width: 600px; margin: 0 auto; flex-wrap: wrap;">
          <input type="text" id="gym-code-check" placeholder="Introduce tu código" style="flex: 1; min-width:200px; padding: 14px; border-radius: 10px; border: 1px solid var(--color-border); background: var(--color-bg); color: var(--color-text); font-size: 16px; text-transform: uppercase;">
          <button class="btn" style="flex: 1; min-width: 150px; border:none;" onclick="checkGymCode()">Comprobar</button>
        </div>
        <div id="gym-code-result" style="text-align: center; margin-top: 20px; font-weight: bold; font-size: 1.1rem;"></div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-grid">
        <div><h4>JalFits Gym</h4><p>El templo del hierro.</p></div>
        <div><h4>Legal Gym</h4><a onclick="navigateAndScroll('view-privacy-gym', 'view-privacy-gym')" style="cursor:pointer;">Privacidad Centro</a><a onclick="navigateAndScroll('view-terms-gym', 'view-terms-gym')" style="cursor:pointer;">Reglamento Interno</a></div>
      </div>
    </footer>
  </div>


  <div id="view-jalfits-register" class="app-view">
    <header class="hero" style="padding: 40px 0;">
      <div class="container">
        <a onclick="navigateAndScroll('view-jalfits', 'view-jalfits')" class="back-link" style="color:white; margin-bottom: 20px; cursor:pointer;">← Atrás</a>
        <h1 style="color:white; margin:0;">Inscripción Online</h1>
      </div>
    </header>
    <main class="container">
      <section style="max-width:600px; margin: 20px auto;">
        <div class="card" style="padding: 30px;">
          <h2 id="reg-plan-title" style="color:var(--color-accent); text-align:center; margin-bottom:20px; font-size:1.5rem;">Plan</h2>
          <form id="gym-register-form" onsubmit="onRegisterSubmit(event)">
            <input type="hidden" name="plan" id="form-plan">
            <input type="hidden" name="price" id="form-price">
            <div class="form-group"><label>Nombre y Apellidos</label><input name="name" required></div>
            <div class="form-group"><label>DNI / NIF</label><input name="dni" required></div>
            <div class="form-group"><label>Dirección (Para enviar tarjeta física NFC)</label><input type="text" name="address" placeholder="Calle, Número, Ciudad"></div>
            <div class="form-group"><label>Método de pago seguro</label>
              <select name="payment" id="gym-payment-method" onchange="toggleGymCardFields()">
                <option value="card">Tarjeta de Crédito / Débito</option>
                <option value="paypal">PayPal</option>
              </select>
            </div>
            
            <div id="gym-credit-card-fields" style="background: var(--color-bg); padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid var(--color-border);">
              <div class="form-group">
                <label>Número de Tarjeta</label>
                <input type="text" id="gym-cc-number" placeholder="0000 0000 0000 0000" pattern="\d{16}" maxlength="16" title="Debe contener exactamente 16 números" required>
              </div>
              <div class="card-fields">
                <div class="form-group" style="flex: 1;">
                  <label>Caducidad</label>
                  <input type="text" id="gym-cc-exp" placeholder="MM/YY" maxlength="5" required>
                </div>
                <div class="form-group" style="flex: 0.6;">
                  <label>CVC</label>
                  <input type="text" id="gym-cc-cvc" placeholder="123" pattern="\d{3,4}" maxlength="4" required>
                </div>
              </div>
            </div>

            <button class="btn" type="submit" style="width:100%; margin-top:15px; padding: 16px; border:none;">Pagar y Generar Tarjeta</button>
          </form>
          <div id="gym-register-result" style="margin-top:20px;"></div>
        </div>
      </section>
    </main>
  </div>


  <div id="view-terms" class="app-view legal-view-bg">
    <div class="legal-container burger-theme">
      <a onclick="navigateAndScroll('view-jalamburguers', 'view-jalamburguers')" class="back-link" style="cursor:pointer;">← Volver a Hamburguesería</a>
      <h1>Términos de Servicio y Condiciones de Uso</h1>
      <p><strong>Última actualización:</strong> 26 de Febrero de 2026</p>
      <h2>1. Aceptación del Servicio y Objeto</h2>
      <p>Al utilizar la plataforma digital de Jalamburguers S.L. y acceder a nuestro programa de fidelización, el Usuario acepta expresa, plena y sin reservas someterse a las presentes Condiciones Generales. Constituyen un contrato legalmente vinculante.</p>
      <h2>2. Funcionamiento del Programa de Fidelidad (Puntos)</h2>
      <ul>
        <li><strong>Acumulación:</strong> 1 punto de fidelidad por cada 1€ de gasto efectivo, excluyendo gastos de envío.</li>
        <li><strong>Caducidad:</strong> Los puntos tienen una validez estricta de 365 días naturales desde la transacción.</li>
        <li><strong>Intransferibilidad:</strong> Los puntos son estrictamente nominativos. No pueden ser vendidos, regalados ni transferidos.</li>
      </ul>
      <h2>3. Políticas de Pedidos y Envíos</h2>
      <p><strong>Modalidad Delivery:</strong> El Usuario es responsable de proporcionar una dirección exacta. Los tiempos de entrega son estimaciones. <strong>Recogida:</strong> Por normativas de sanidad alimentaria, los pedidos no reclamados tras 60 minutos serán desechados sin derecho a reembolso.</p>
    </div>
  </div>

  <div id="view-privacy" class="app-view legal-view-bg">
    <div class="legal-container burger-theme">
      <a onclick="navigateAndScroll('view-jalamburguers', 'view-jalamburguers')" class="back-link" style="cursor:pointer;">← Volver a Hamburguesería</a>
      <h1>Política de Privacidad y Protección de Datos</h1>
      <p><strong>Última actualización:</strong> 26 de Febrero de 2026</p>
      <h2>1. Compromiso de Transparencia</h2>
      <p>Recopilamos su correo electrónico, nombre y dirección de envío con el único propósito de procesar sus transacciones y mantener su cuenta de puntos. <strong>No comercializamos ni vendemos</strong> sus datos personales a terceras agencias bajo ningún concepto.</p>
      <h2>2. Seguridad Financiera</h2>
      <p>Jalamburguers no almacena números de tarjeta en sus servidores. Toda transacción es delegada y cifrada mediante pasarelas externas certificadas (Stripe/PayPal) bajo estándares PCI-DSS.</p>
      <h2>3. Derechos del Usuario (RGPD)</h2>
      <p>Usted tiene derecho absoluto de acceder a sus datos, rectificarlos o solicitar la eliminación permanente (Derecho al Olvido). Contacte con nuestro DPO en <em>privacy@jalamburguers.com</em>.</p>
    </div>
  </div>

  <div id="view-terms-gym" class="app-view legal-view-bg">
    <div class="legal-container gym-theme">
      <a onclick="navigateAndScroll('view-jalfits', 'view-jalfits')" class="back-link" style="cursor:pointer;">← Volver al Gym</a>
      <h1>Reglamento Interno y Condiciones JalFits</h1>
      <h2>1. Normativa de Acceso</h2>
      <p>El código de tarjeta (digital o físico) es <strong>personal e intransferible</strong>. Ceder el acceso a individuos no asociados constituye una infracción gravísima, resultando en la expulsión permanente sin reembolso.</p>
      <h2>2. Exención de Responsabilidad Médica</h2>
      <p>El uso de maquinaria de musculación conlleva riesgos inherentes. El socio asume total responsabilidad por su bienestar físico, eximiendo a JalFits de responsabilidad civil frente a lesiones o accidentes derivados de malas prácticas de entrenamiento.</p>
    </div>
  </div>

  <div id="view-privacy-gym" class="app-view legal-view-bg">
    <div class="legal-container gym-theme">
      <a onclick="navigateAndScroll('view-jalfits', 'view-jalfits')" class="back-link" style="cursor:pointer;">← Volver al Gym</a>
      <h1>Privacidad Biomecánica (JalFits)</h1>
      <h2>1. Cámaras de Seguridad</h2>
      <p>El recinto cuenta con circuito cerrado 24/7 en zonas comunes por seguridad de la maquinaria y usuarios. Grabaciones eliminadas cada 30 días.</p>
      <h2>2. Tratamiento de Datos Médicos</h2>
      <p>Si el socio contrata entrenamiento personal, los datos de biometría, lesiones y salud se tratarán bajo estricto "Secreto Médico" profesional, accesibles únicamente por su instructor asignado.</p>
    </div>
  </div>

  <div id="customize-modal" class="modal-overlay">
    <div class="modal" style="max-width: 400px;">
      <div class="modal-header" style="border:none; padding-bottom: 0;">
        <h2 id="cust-name" style="margin-bottom: 0;">Producto</h2>
        <button class="modal-close" onclick="closeCustomize()">✕</button>
      </div>
      <div class="modal-body" style="display:block; padding-top: 10px;">
        <p id="cust-price" style="font-size: 1.8rem; color: var(--color-accent); font-weight: 900; margin-top: 0; margin-bottom: 20px;">0.00€</p>
        
        <div id="cust-options">
          </div>

        <div class="form-group" style="margin-top: 25px;">
          <label>Cantidad</label>
          <input type="number" id="cust-qty" value="1" min="1" max="10" style="font-size: 1.2rem; font-weight: bold; text-align: center;">
        </div>
        
        <button class="btn" style="width: 100%; margin-top: 15px;" onclick="confirmAddToCart()">Añadir al Carrito</button>
      </div>
    </div>
  </div>

  <div id="auth-modal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2 id="auth-title">Acceso</h2>
        <button class="modal-close" onclick="closeAuth()">✕</button>
      </div>
      <div class="modal-body" style="display:block;">
        <div id="tab-login" class="auth-tab active">
          <form onsubmit="handleLogin(event)">
            <div class="form-group"><label>Email</label><input type="email" id="login-email" required></div>
            <div class="form-group"><label>Contraseña</label><input type="password" id="login-password" required></div>
            <button type="submit" class="btn" style="width:100%; margin-top:10px; border:none;">Entrar</button>
          </form>
          <p style="text-align:center; margin-top:20px;">¿Nuevo aquí? <a onclick="switchTab('tab-register')" style="color:var(--color-accent); font-weight:bold; cursor:pointer;">Crear cuenta</a></p>
        </div>
        <div id="tab-register" class="auth-tab">
          <form onsubmit="handleRegister(event)">
            <div class="form-group"><label>Nombre Completo</label><input type="text" id="reg-name" required></div>
            <div class="form-group"><label>Email</label><input type="email" id="reg-email" required></div>
            <div class="form-group"><label>Contraseña</label><input type="password" id="reg-password" required></div>
            <button type="submit" class="btn" style="width:100%; margin-top:10px; border:none;">Registrarse</button>
          </form>
          <p style="text-align:center; margin-top:20px;">¿Ya tienes cuenta? <a onclick="switchTab('tab-login')" style="color:var(--color-accent); font-weight:bold; cursor:pointer;">Inicia Sesión</a></p>
        </div>
      </div>
    </div>
  </div>

  <div id="checkout-modal" class="modal-overlay">
    <div class="modal" style="max-width: 500px;">
      <div class="modal-header">
        <h2><svg class="icon"><use href="#i-cart"/></svg> Confirmar Pedido</h2>
        <button class="modal-close" onclick="closeCheckout()">✕</button>
      </div>
      <div class="modal-body" style="display:block;">
        <div id="cart-items" style="background: var(--color-bg); padding: 15px; border-radius: 10px; margin-bottom: 20px;"></div>
        
        <div class="form-group">
          <label>¿Cómo lo quieres?</label>
          <select id="cart-delivery" onchange="toggleDelivery()">
            <option value="pickup">Recoger en el Local (Gratis)</option>
            <option value="delivery">Envío a Domicilio (+2.50€)</option>
          </select>
        </div>
        <div class="form-group" id="address-box" style="display:none;">
          <label>Dirección de Envío Completa</label>
          <input type="text" id="cart-address" placeholder="Ej: Calle Principal 123, Puerta 2">
        </div>

        <div class="form-group">
          <label>Método de Pago</label>
          <select id="cart-payment" onchange="toggleBurgerCardFields()">
            <option value="card">Tarjeta de Crédito / Débito</option>
            <option value="paypal">PayPal</option>
            <option value="cash">Pagar al Recibir/Recoger</option>
          </select>
        </div>

        <div id="burger-credit-card-fields" style="background: rgba(0,0,0,0.02); padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid var(--color-border);">
          <div class="form-group">
            <label>Número de Tarjeta</label>
            <input type="text" id="burger-cc-number" placeholder="0000 0000 0000 0000" pattern="\d{16}" maxlength="16" title="Debe contener exactamente 16 números" required>
          </div>
          <div class="card-fields">
            <div class="form-group" style="flex: 1;">
              <label>Caducidad</label>
              <input type="text" id="burger-cc-exp" placeholder="MM/YY" maxlength="5" required>
            </div>
            <div class="form-group" style="flex: 0.6;">
              <label>CVC</label>
              <input type="text" id="burger-cc-cvc" placeholder="123" pattern="\d{3,4}" maxlength="4" required>
            </div>
          </div>
        </div>

        <div style="display: flex; justify-content: space-between; font-size: 1.5rem; font-weight: 900; color: var(--color-accent); margin: 20px 0; padding-top: 20px; border-top: 2px solid var(--color-border);">
          <span>TOTAL:</span><span id="cart-total">0.00€</span>
        </div>
        <button class="btn" style="width:100%; font-size: 1.1rem; padding: 16px; border:none;" onclick="processOrder()">Pagar Ahora</button>
      </div>
    </div>
  </div>

  <div class="toast-container" id="toast-container"></div>

  <script>
    /* ==========================================
       1. ENRUTADOR, TEMAS Y NAVEGACIÓN
       ========================================== */
    function handleRoute() {
      const hash = window.location.hash || '#jalamburguers';
      document.querySelectorAll('.app-view').forEach(v => v.classList.remove('active'));
      const targetId = 'view-' + hash.replace('#', '').split('?')[0];
      const view = document.getElementById(targetId) || document.getElementById('view-jalamburguers');
      view.classList.add('active');
      window.scrollTo(0, 0);

      const isGym = hash.includes('jalfits') || hash.includes('gym');
      if(isGym) {
        document.body.classList.add('gym-theme');
      } else {
        document.body.classList.remove('gym-theme');
      }

      document.querySelectorAll('.main-nav').forEach(nav => nav.classList.remove('active-mobile'));

      if(hash.includes('jalfits-register')) {
        const urlParams = new URLSearchParams(hash.split('?')[1]);
        const plan = urlParams.get('plan') || 'Básico';
        const price = urlParams.get('price') || '29';
        document.getElementById('reg-plan-title').innerText = `Contratar: ${plan} (${price}€/mes)`;
        document.getElementById('form-plan').value = plan;
        document.getElementById('form-price').value = price;
        document.getElementById('gym-register-result').innerHTML = '';
      }
    }
    window.addEventListener('hashchange', handleRoute);
    window.addEventListener('DOMContentLoaded', handleRoute);

    function navigateAndScroll(viewId, sectionId) {
      if (!document.getElementById(viewId).classList.contains('active')) {
        window.location.hash = '#' + viewId.replace('view-', '');
        setTimeout(() => { document.getElementById(sectionId).scrollIntoView({behavior:'smooth'}); }, 100);
      } else {
        document.getElementById(sectionId).scrollIntoView({behavior:'smooth'});
      }
      document.querySelectorAll('.main-nav').forEach(nav => nav.classList.remove('active-mobile'));
    }

    function toggleMobileMenu() { 
      const activeNav = document.querySelector('.app-view.active .main-nav');
      if(activeNav) activeNav.classList.toggle('active-mobile'); 
    }

    function showCategory(event, categoryId) {
      const activeView = document.querySelector('.app-view.active');
      activeView.querySelectorAll('.menu-category').forEach(cat => cat.classList.remove('active'));
      document.getElementById(categoryId).classList.add('active');
      activeView.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    let currentSlide = 0;
    function showSlide(n) {
      const slides = document.querySelectorAll('#gym-carousel .carousel-slide');
      if(!slides.length) return;
      slides[currentSlide].classList.remove('active');
      currentSlide = (n + slides.length) % slides.length;
      slides[currentSlide].classList.add('active');
    }
    function carouselNext() { showSlide(currentSlide + 1); }
    function carouselPrev() { showSlide(currentSlide - 1); }
    setInterval(() => { if(document.body.classList.contains('gym-theme')) carouselNext(); }, 6000);

    const Toasts = {
      show: (title, message, type) => {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        let iconHtml = '';
        if(type === 'success') iconHtml = `<svg class="icon" style="width:24px;height:24px;stroke:#10b981;"><polyline points="20 6 9 17 4 12"/></svg>`;
        else iconHtml = `<svg class="icon" style="width:24px;height:24px;stroke:#ef4444;"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>`;

        toast.innerHTML = `${iconHtml} <div style="flex:1;"><strong style="font-size:1.05rem;">${title}</strong><br><span style="font-size:0.9rem; opacity:0.9;">${message}</span></div><button class="toast-close" onclick="this.parentElement.remove()">✕</button>`;
        container.appendChild(toast);
        setTimeout(() => { if(toast.parentElement) toast.remove(); }, 4000);
      },
      success: (t, m) => Toasts.show(t, m, 'success'),
      error: (t, m) => Toasts.show(t, m, 'error')
    };

    class Auth {
      constructor() {
        this.users = JSON.parse(localStorage.getItem('jal_users')) || {};
        this.currentUser = JSON.parse(localStorage.getItem('jal_session')) || null;
        this.updateUI();
      }
      register(name, email, pass) {
        if(this.users[email]) return Toasts.error('Atención', 'Este email ya está en uso.');
        this.users[email] = { name, email, pass, points: 0, purchases: 0, revenue: 0 };
        localStorage.setItem('jal_users', JSON.stringify(this.users));
        Toasts.success('Cuenta Creada', 'Bienvenido a la élite. Inicia sesión.');
        switchTab('tab-login');
      }
      login(email, pass) {
        const user = this.users[email];
        if(!user || user.pass !== pass) return Toasts.error('Error', 'Email o contraseña incorrectos.');
        this.currentUser = user;
        localStorage.setItem('jal_session', JSON.stringify(this.currentUser));
        Toasts.success('Acceso Permitido', `Hola de nuevo, ${user.name}`);
        this.updateUI();
        closeAuth();
      }
      logout() {
        this.currentUser = null;
        localStorage.removeItem('jal_session');
        Toasts.show('Desconectado', 'Has cerrado sesión.', 'info');
        this.updateUI();
      }
      addPurchaseData(pts, money) {
        if(!this.currentUser) return;
        this.currentUser.points += pts;
        this.currentUser.purchases += 1;
        this.currentUser.revenue += money;
        this.users[this.currentUser.email] = this.currentUser;
        localStorage.setItem('jal_users', JSON.stringify(this.users));
        localStorage.setItem('jal_session', JSON.stringify(this.currentUser));
        this.updateUI();
      }
      updateUI() {
        const btns = document.querySelectorAll('.auth-btn');
        if(this.currentUser) {
          btns.forEach(b => { b.innerHTML = `<svg class="icon"><use href="#i-user"/></svg> ${this.currentUser.name}`; b.onclick = () => { if(confirm('¿Quieres cerrar tu sesión?')) this.logout(); }; });
          const p = document.getElementById('points'); if(p) p.innerText = this.currentUser.points;
          const pu = document.getElementById('purchases'); if(pu) pu.innerText = this.currentUser.purchases;
          const r = document.getElementById('revenue'); if(r) r.innerText = this.currentUser.revenue.toFixed(2) + '€';
        } else {
          btns.forEach(b => { b.innerHTML = `<svg class="icon"><use href="#i-login"/></svg> Ingresar`; b.onclick = () => openAuthModal(); });
          const p = document.getElementById('points'); if(p) p.innerText = '0';
          const pu = document.getElementById('purchases'); if(pu) pu.innerText = '0';
          const r = document.getElementById('revenue'); if(r) r.innerText = '0.00€';
        }
      }
    }
    const authManager = new Auth();

    function openAuthModal() { document.getElementById('auth-modal').classList.add('active'); }
    function closeAuth() { document.getElementById('auth-modal').classList.remove('active'); }
    function switchTab(t) { document.querySelectorAll('.auth-tab').forEach(x=>x.classList.remove('active')); document.getElementById(t).classList.add('active'); }
    function handleRegister(e) { e.preventDefault(); authManager.register(document.getElementById('reg-name').value, document.getElementById('reg-email').value, document.getElementById('reg-password').value); }
    function handleLogin(e) { e.preventDefault(); authManager.login(document.getElementById('login-email').value, document.getElementById('login-password').value); }

    /* ==========================================
       5. SISTEMA DE PERSONALIZACIÓN Y CARRITO
       ========================================== */
    let cart = JSON.parse(localStorage.getItem('jal_cart')) || [];
    updateCartCount();

    // Variables temporales para el modal de personalización
    let tempItem = null;

    const CustomOptions = {
      'burger': [
        { id: 'bacon', label: '+ Extra Bacon Pavo', price: 1.50, type: 'add' },
        { id: 'queso', label: '+ Doble Queso Proteico', price: 1.00, type: 'add' },
        { id: 'huevo', label: '+ Huevo Plancha', price: 1.00, type: 'add' },
        { id: 'no-tomate', label: 'Sin Tomate', price: 0, type: 'remove' },
        { id: 'no-cebolla', label: 'Sin Cebolla', price: 0, type: 'remove' }
      ],
      'side': [
        { id: 'salsa-queso', label: '+ Salsa de Queso Light', price: 1.00, type: 'add' },
        { id: 'salsa-bbq', label: '+ Salsa BBQ Zero', price: 0.50, type: 'add' }
      ],
      'drink': [
        { id: 'extra-scoop', label: '+ Scoop Extra Whey', price: 1.50, type: 'add' },
        { id: 'leche-avena', label: 'Leche de Avena', price: 0.50, type: 'add' },
        { id: 'no-hielo', label: 'Sin Hielo', price: 0, type: 'remove' }
      ],
      'dessert': [
        { id: 'sirope', label: '+ Sirope Cacao Puro', price: 0.50, type: 'add' }
      ],
      'combo': [
        { id: 'agrandar', label: '+ Agrandar Papas y Bebida', price: 2.50, type: 'add' }
      ]
    };

    function openCustomize(id, name, price, pts, type) {
      if(!authManager.currentUser) { Toasts.error('Sesión Requerida', 'Inicia sesión para comprar y ganar puntos.'); openAuthModal(); return; }
      
      tempItem = { id, name, basePrice: price, price, pts, type, options: [], qty: 1 };
      
      document.getElementById('cust-name').innerText = name;
      document.getElementById('cust-price').innerText = price.toFixed(2) + '€';
      document.getElementById('cust-qty').value = 1;
      
      const optionsContainer = document.getElementById('cust-options');
      optionsContainer.innerHTML = '';

      if(CustomOptions[type]) {
        CustomOptions[type].forEach(opt => {
          let priceTag = opt.price > 0 ? `<span class="custom-option-price">+${opt.price.toFixed(2)}€</span>` : `<span style="color:var(--color-text-light);">Gratis</span>`;
          optionsContainer.innerHTML += `
            <label class="custom-option">
              <div style="display:flex; align-items:center; gap:10px;">
                <input type="checkbox" value="${opt.id}" data-price="${opt.price}" data-label="${opt.label}" onchange="updateTempPrice()">
                <span>${opt.label}</span>
              </div>
              ${priceTag}
            </label>
          `;
        });
      }
      
      document.getElementById('customize-modal').classList.add('active');
    }

    function updateTempPrice() {
      if(!tempItem) return;
      let newPrice = tempItem.basePrice;
      const checkboxes = document.querySelectorAll('#cust-options input[type="checkbox"]:checked');
      
      tempItem.options = [];
      checkboxes.forEach(cb => {
        newPrice += parseFloat(cb.dataset.price);
        tempItem.options.push(cb.dataset.label);
      });
      
      tempItem.price = newPrice;
      document.getElementById('cust-price').innerText = newPrice.toFixed(2) + '€';
    }

    function confirmAddToCart() {
      if(!tempItem) return;
      const qty = parseInt(document.getElementById('cust-qty').value) || 1;
      tempItem.qty = qty;
      
      // Crear un "identificador único" basado en el producto y sus opciones elegidas
      const uniqueCartId = tempItem.id + '_' + tempItem.options.join('-');
      
      const existing = cart.find(i => i.uniqueCartId === uniqueCartId);
      if(existing) {
        existing.qty += qty;
      } else {
        cart.push({
          uniqueCartId: uniqueCartId,
          id: tempItem.id,
          name: tempItem.name,
          price: tempItem.price,
          pts: tempItem.pts,
          qty: tempItem.qty,
          options: tempItem.options
        });
      }
      
      localStorage.setItem('jal_cart', JSON.stringify(cart));
      updateCartCount();
      closeCustomize();
      Toasts.success('Añadido al Carrito', `${qty}x ${tempItem.name}`);
    }

    function closeCustomize() { document.getElementById('customize-modal').classList.remove('active'); tempItem = null; }

    function openCartModal() {
      if(!authManager.currentUser) { Toasts.error('Sesión Requerida', 'Inicia sesión para ver tu carrito.'); openAuthModal(); return; }
      renderCart();
      document.getElementById('checkout-modal').classList.add('active');
    }

    function updateCartCount() {
      const count = cart.reduce((sum, item) => sum + item.qty, 0);
      const badge = document.getElementById('cart-count-badge');
      if(badge) {
        badge.innerText = count;
        badge.style.display = count > 0 ? 'inline-block' : 'none';
      }
    }

    function renderCart() {
      const container = document.getElementById('cart-items');
      container.innerHTML = '';
      let total = 0;
      if(cart.length === 0) { container.innerHTML = '<p style="text-align:center; font-weight:bold;">Tu carrito está vacío.</p>'; document.getElementById('cart-total').innerText = '0.00€'; updateCartCount(); return; }
      
      cart.forEach((item, index) => {
        total += item.price * item.qty;
        
        let optionsHtml = '';
        if(item.options && item.options.length > 0) {
          optionsHtml = `<div style="font-size: 0.8rem; color: var(--color-text-light); margin-top: 4px;">${item.options.join(', ')}</div>`;
        }

        container.innerHTML += `
          <div style="display:flex; justify-content:space-between; align-items:center; padding:12px 0; border-bottom:1px solid var(--color-border);">
            <div style="flex:1;">
              <strong style="color:var(--color-text);">${item.name}</strong> <span style="color:var(--color-text-light); font-weight:bold;">x${item.qty}</span>
              ${optionsHtml}
            </div>
            <div style="display:flex; align-items:center; gap:15px; margin-left:10px;">
              <span style="color:var(--color-accent); font-weight:bold;">${(item.price * item.qty).toFixed(2)}€</span>
              <button onclick="removeItem(${index})" style="background:#ef4444; color:white; border:none; border-radius:8px; padding:6px 12px; cursor:pointer; font-weight:bold;">✕</button>
            </div>
          </div>`;
      });
      const mode = document.getElementById('cart-delivery').value;
      if(mode === 'delivery') total += 2.50; 
      document.getElementById('cart-total').innerText = total.toFixed(2) + '€';
      updateCartCount();
      toggleBurgerCardFields(); // Check if fields need to be required
    }

    function removeItem(index) { cart.splice(index, 1); localStorage.setItem('jal_cart', JSON.stringify(cart)); renderCart(); }
    
    function toggleDelivery() { document.getElementById('address-box').style.display = document.getElementById('cart-delivery').value === 'delivery' ? 'block' : 'none'; renderCart(); }
    
    function toggleBurgerCardFields() {
      const method = document.getElementById('cart-payment').value;
      const ccFields = document.getElementById('burger-credit-card-fields');
      const ccNumber = document.getElementById('burger-cc-number');
      const ccExp = document.getElementById('burger-cc-exp');
      const ccCvc = document.getElementById('burger-cc-cvc');
      
      if(method === 'card') {
        ccFields.style.display = 'block';
        ccNumber.setAttribute('required', 'true');
        ccExp.setAttribute('required', 'true');
        ccCvc.setAttribute('required', 'true');
      } else {
        ccFields.style.display = 'none';
        ccNumber.removeAttribute('required');
        ccExp.removeAttribute('required');
        ccCvc.removeAttribute('required');
      }
    }

    function closeCheckout() { document.getElementById('checkout-modal').classList.remove('active'); }

    function processOrder() {
      if(cart.length === 0) return Toasts.error('Error', 'Añade productos antes de pagar.');
      
      const mode = document.getElementById('cart-delivery').value;
      const addr = document.getElementById('cart-address').value;
      const paymentMethod = document.getElementById('cart-payment').value;

      if(mode === 'delivery' && !addr.trim()) return Toasts.error('Falta Dirección', 'Escribe a dónde enviamos el pedido.');
      
      // Validación estricta de Tarjeta si está seleccionada
      if(paymentMethod === 'card') {
        const ccNum = document.getElementById('burger-cc-number').value.replace(/\s/g, '');
        const ccExp = document.getElementById('burger-cc-exp').value;
        const ccCvc = document.getElementById('burger-cc-cvc').value;

        if(ccNum.length !== 16 || isNaN(ccNum)) {
          return Toasts.error('Tarjeta Inválida', 'El número de tarjeta debe tener exactamente 16 dígitos numéricos.');
        }
        if(!ccExp || !ccCvc) {
          return Toasts.error('Datos Incompletos', 'Rellena la caducidad y el CVC.');
        }
      }
      
      let totalMoney = mode === 'delivery' ? 2.50 : 0;
      let totalPts = 0;
      cart.forEach(i => { totalMoney += i.price * i.qty; totalPts += i.pts * i.qty; });
      
      authManager.addPurchaseData(totalPts, totalMoney);
      cart = []; localStorage.setItem('jal_cart', JSON.stringify(cart));
      updateCartCount();
      closeCheckout();
      
      const msg = mode === 'delivery' ? `Pedido en camino a: ${addr}` : `Te esperamos en la barra para recoger.`;
      Toasts.success('¡Pago Aprobado!', `${msg} <br>Has sumado <strong>+${totalPts} pts</strong>.`);
      
      // Limpiar campos tarjeta
      document.getElementById('burger-cc-number').value = '';
      document.getElementById('burger-cc-exp').value = '';
      document.getElementById('burger-cc-cvc').value = '';
    }

    /* ==========================================
       6. CANJEO DE RECOMPENSAS
       ========================================== */
    function redeemReward(rewardName, pointsNeeded) {
      if(!authManager.currentUser) { Toasts.error('Inicia sesión', 'Necesitas tu cuenta para canjear.'); openAuthModal(); return; }
      if(authManager.currentUser.points >= pointsNeeded) {
        if(confirm(`¿Deseas gastar ${pointsNeeded} puntos en: ${rewardName}?`)) {
          authManager.currentUser.points -= pointsNeeded;
          authManager.users[authManager.currentUser.email] = authManager.currentUser;
          localStorage.setItem('jal_users', JSON.stringify(authManager.users));
          localStorage.setItem('jal_session', JSON.stringify(authManager.currentUser));
          authManager.updateUI();
          Toasts.success('¡Premio Desbloqueado!', `Disfruta de tu ${rewardName}.`);
        }
      } else { Toasts.error('Puntos insuficientes', `Te faltan ${pointsNeeded - authManager.currentUser.points} puntos.`); }
    }

    /* ==========================================
       7. TARJETAS GYM JALFITS
       ========================================== */
    function toggleGymCardFields() {
      const method = document.getElementById('gym-payment-method').value;
      const ccFields = document.getElementById('gym-credit-card-fields');
      const ccNumber = document.getElementById('gym-cc-number');
      const ccExp = document.getElementById('gym-cc-exp');
      const ccCvc = document.getElementById('gym-cc-cvc');
      
      if(method === 'card') {
        ccFields.style.display = 'block';
        ccNumber.setAttribute('required', 'true');
        ccExp.setAttribute('required', 'true');
        ccCvc.setAttribute('required', 'true');
      } else {
        ccFields.style.display = 'none';
        ccNumber.removeAttribute('required');
        ccExp.removeAttribute('required');
        ccCvc.removeAttribute('required');
      }
    }

    function selectPlan(planName, price) { window.location.hash = `#jalfits-register?plan=${planName}&price=${price}`; }

    function onRegisterSubmit(e) {
      e.preventDefault();
      
      const paymentMethod = document.getElementById('gym-payment-method').value;
      if(paymentMethod === 'card') {
        const ccNum = document.getElementById('gym-cc-number').value.replace(/\s/g, '');
        if(ccNum.length !== 16 || isNaN(ccNum)) {
          return Toasts.error('Tarjeta Inválida', 'El número de tarjeta debe tener exactamente 16 dígitos numéricos.');
        }
      }

      const plan = document.getElementById('form-plan').value;
      const name = e.target.name.value;
      const address = e.target.address.value;
      const code = 'JAL-' + Math.floor(1000 + Math.random() * 9000) + '-' + Math.random().toString(36).substring(2, 6).toUpperCase();
      const expiry = new Date(); expiry.setDate(expiry.getDate() + (plan === 'PaseDia' ? 1 : 30));
      const card = { code, name, plan, address, expiryDate: expiry.toISOString() };
      
      let cards = JSON.parse(localStorage.getItem('gym_cards')) || [];
      cards.push(card); localStorage.setItem('gym_cards', JSON.stringify(cards));

      let extraMsg = address ? `Enviaremos la tarjeta NFC a: <strong>${address}</strong> en 48h.` : `Usa este código en los tornos de entrada.`;
      document.getElementById('gym-register-result').innerHTML = `<div style="background:var(--color-bg); border:2px solid var(--color-accent); padding:20px; border-radius:15px; text-align:center; color:var(--color-text); margin-top: 20px;"><h3 style="color:var(--color-accent); margin-top:0;">✅ ¡Pago Procesado!</h3><p>Tu código de socio activo es:</p><h2 style="font-size:2rem; letter-spacing:3px; margin:10px 0; background:#000; padding:10px; border-radius:10px; color:white;">${code}</h2><p style="font-size:0.9rem; color:var(--color-text-light);">${extraMsg}</p><button class="btn" style="margin-top:10px; border:none;" onclick="window.location.hash='#jalfits'">Entrar al Portal</button></div>`;
      e.target.reset();
      toggleGymCardFields();
    }

    function checkGymCode() {
      const codeInput = document.getElementById('gym-code-check').value.toUpperCase().trim();
      const resultDiv = document.getElementById('gym-code-result');
      if(!codeInput) return resultDiv.innerHTML = '<span style="color:#ef4444;">Por favor, introduce tu código.</span>';

      let cards = JSON.parse(localStorage.getItem('gym_cards')) || [];
      const card = cards.find(c => c.code === codeInput);
      
      if(card) {
        const diasRestantes = Math.ceil((new Date(card.expiryDate) - new Date()) / (1000 * 60 * 60 * 24));
        if(diasRestantes > 0) { resultDiv.innerHTML = `<div style="background:rgba(16, 185, 129, 0.1); padding:20px; border-radius:10px; border:1px solid #10b981;"><span style="color:#10b981; font-size:1.2rem;">✅ TARJETA ACTIVA</span><br><br><span style="color:var(--color-text); font-weight:normal;">Titular: <strong>${card.name}</strong><br>Plan: <strong>${card.plan.toUpperCase()}</strong><br>Tiempo restante: <strong>${diasRestantes} días</strong></span></div>`; } 
        else { resultDiv.innerHTML = `<div style="background:rgba(239, 68, 68, 0.1); padding:20px; border-radius:10px; border:1px solid #ef4444;"><span style="color:#ef4444; font-size:1.2rem;">❌ TARJETA CADUCADA</span><br><br><span style="color:var(--color-text); font-weight:normal;">Expiró hace ${Math.abs(diasRestantes)} días.</span></div>`; }
      } else { resultDiv.innerHTML = '<span style="color:#f59e0b;">⚠️ Código no encontrado. Revisa si lo has escrito bien.</span>'; }
    }
  </script>
</body>
</html>