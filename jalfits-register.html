<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro JalFits - Completa tu inscripción</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body class="gym">
  <header class="hero gym" style="position:relative;">
    <img src="images/gym-logo.png" alt="JalFits" class="logo-circular-top-right" style="border-color:var(--color-accent);">
    <div class="container">
      <nav class="nav-row">
        <a href="index.html" class="logo-brand">JalFits</a>
        <nav class="main-nav">
          <a href="jalfits.html">Planes</a>
          <a href="#">Contacto</a>
        </nav>
      </nav>
      <div class="hero-inner">
        <h1>Registro para membresía JalFits</h1>
        <p class="lead">Completa los datos para activar tu plan y recibir tu tarjeta física.</p>
      </div>
    </div>
  </header>

  <main class="container">
    <section style="max-width:720px; margin: 20px auto;">
      <div class="card">
        <h2>Formulario de registro</h2>
        <p class="muted">Rellena los datos. El pago se simula en esta demo.</p>

        <form id="gym-register-form" onsubmit="onRegisterSubmit(event)">
          <input type="hidden" name="plan" id="form-plan" value="mensual">
          <input type="hidden" name="price" id="form-price" value="30">

          <div class="form-group">
            <label>Nombre completo</label>
            <input name="name" required>
          </div>

          <div class="form-group">
            <label>DNI / NIF</label>
            <input name="dni" required>
          </div>

          <div class="form-group">
            <label>Método de pago</label>
            <select name="payment">
              <option value="card">Tarjeta</option>
              <option value="transfer">Transferencia</option>
              <option value="cash">Efectivo en recepción</option>
            </select>
          </div>

          <div style="display:flex; gap:8px; margin-top:12px;">
            <button class="btn" type="submit">Pagar y registrar</button>
            <a class="btn ghost" href="jalfits.html">Cancelar</a>
          </div>
        </form>

        <div id="gym-register-result" style="margin-top:16px;"></div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">&copy; JalFits</div>
  </footer>

  <script src="js/notifications.js"></script>
  <script src="js/cookies.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/gym.js"></script>
  <script>
    // Pre-fill form from query params
    function qs() { return new URLSearchParams(window.location.search); }
    const params = qs();
    const plan = params.get('plan') || 'mensual';
    const price = params.get('price') || (plan === 'trimestral' ? '75' : '30');
    const discount = params.get('discount') === '1';

    document.getElementById('form-plan').value = plan;
    document.getElementById('form-price').value = discount ? (parseFloat(price) * 0.7).toFixed(2) : price;

    function onRegisterSubmit(e) {
      e.preventDefault();
      const form = document.getElementById('gym-register-form');
      // attach plan + price hidden inputs
      form.querySelector('[name="plan"]').value = plan;
      form.querySelector('[name="price"]').value = document.getElementById('form-price').value;
      Gym.registerFromForm(form);
    }
  </script>
</body>
</html>
